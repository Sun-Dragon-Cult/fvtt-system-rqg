<form class="{{cssClass}}" autocomplete="off">
  {{!-- Sheet Header --}}
  <header class="sheet-header">
    <img
      class="profile-img"
      src="{{actor.img}}"
      data-edit="img"
      title="{{actor.name}}"
    />
    <div>
      <div class="topheaderline">
        <h1 class="charname norse">
          <input
            name="name"
            type="text"
            value="{{actor.name}}"
            placeholder=""
          />
        </h1>
        <br />
        <label class="mp norse"
          >Magic Points<br />
          <input
            type="number"
            min="0"
            max="99"
            name="data.attributes.magicPoints.value"
            value="{{data.attributes.magicPoints.value}}"
            data-dtype="Number"
            size="2"
          />
          / {{data.attributes.magicPoints.max}}
        </label>
      </div>
      <div class="characteristics">
        {{#each data.characteristics as | characteristic key |}}
        <div>
          <label class="resource-label norse"
            >{{localize (concat 'characteristic.' key)}}</label
          ><br />
          <input
            type="number"
            min="0"
            max="99"
            name="data.characteristics.{{key}}.value"
            value="{{characteristic.value}}"
            data-dtype="Number"
            size="2"
          />

          <!--        <span class="ability-mod rollable" data-roll="d20+@abilities.{{key}}.mod" data-label="{{key}}">{{numberFormat
                    ability.mod decimals=0 sign=true}}</span>-->
        </div>
        {{/each}}
      </div>
      <div class="thirdline">
        <div>
          <span class="norse">SIZ SR</span> {{data.attributes.sizStrikeRank}}
        </div>
        <div>
          <span class="norse">DEX SR</span> {{data.attributes.dexStrikeRank}}
        </div>
        <div>
          <span class="norse">Max ENC</span>
          {{data.attributes.maximumEncumbrance}}
        </div>
        <div>
          <span class="norse">Equipped ENC</span>
          {{data.attributes.equippedEncumbrance}}
        </div>
        <div>
          <span class="norse">Travel ENC</span>
          {{data.attributes.travelEncumbrance}}
        </div>
      </div>
    </div>
  </header>
  <div class="runeline">
    <img src="systems/rqg/assets/icons/runes/mastery.svg" />
    <img src="systems/rqg/assets/icons/runes/magic.svg" />
    <img src="systems/rqg/assets/icons/runes/disorder.svg" />
    <img src="systems/rqg/assets/icons/runes/movement_change.svg" />
    <img src="systems/rqg/assets/icons/runes/moon_full.svg" />
    <img src="systems/rqg/assets/icons/runes/spirit.svg" />
    <img src="systems/rqg/assets/icons/runes/death.svg" />
    <img src="systems/rqg/assets/icons/runes/illusion.svg" />
    <img src="systems/rqg/assets/icons/runes/dragonnewt.svg" />
    <img src="systems/rqg/assets/icons/runes/darkness.svg" />
    <img src="systems/rqg/assets/icons/runes/truth.svg" />
    <img src="systems/rqg/assets/icons/runes/stasis.svg" />
    <img src="systems/rqg/assets/icons/runes/luck.svg" />
    <img src="systems/rqg/assets/icons/runes/plant.svg" />
    <img src="systems/rqg/assets/icons/runes/water.svg" />
    <img src="systems/rqg/assets/icons/runes/beast.svg" />
    <img src="systems/rqg/assets/icons/runes/air.svg" />
    <img src="systems/rqg/assets/icons/runes/man.svg" />
    <img src="systems/rqg/assets/icons/runes/earth.svg" />
    <img src="systems/rqg/assets/icons/runes/harmony.svg" />
    <img src="systems/rqg/assets/icons/runes/fertility.svg" />
    <img src="systems/rqg/assets/icons/runes/fate.svg" />
    <img src="systems/rqg/assets/icons/runes/chaos.svg" />
  </div>

  <div class="flex-row flex-wrap">
    {{> "systems/rqg/actors/parts/armor.html" }}
    <div>
      <h2 class="norse">Combat</h2>
      <div class="flexrow flex-align-center">
        <label class="norse">Damage Bonus {{data.attributes.damageBonus}}</label>
        <a class="text-right norse" data-item-id="{{this.data.dodgeSkill._id}}" data-item-roll>Dodge {{skillchance this.data.dodgeSkill._id this.actor._id}}%</a>
      </div>
      <table>
        <thead>
          <tr>
            <th class="text-left">Weapon</th>
            <th class="text-right">Chance</th>
            <th class="text-left" colspan="2">HP</th>
            <th class="text-left">Actions</th>
          </tr>
        </thead>
        <tbody>
        {{#each data.ownedItems.meleeWeapon}}
          {{#if this.data.data.equipped}}
          <tr data-skill-id="{{data.data.skillId}}" data-item-id="{{data._id}}">
            <td>{{this.name}}</td>
            <td class="text-right">{{skillchance this.data.data.skillId this.actor._id}}%</td>
            <td class="text-right"><input type="number" data-dtype="Number" data-item-edit-value="data.hitPoints.value" value="{{this.data.data.hitPoints.value}}"> /</td>
            <td class="text-right">{{this.data.data.hitPoints.max}}</td>
            <td class="text-left">
              {{#each this.data.data.attackTypes}}
              <a data-weapon-roll="{{this}}">{{this}}</a>
              {{/each}}
            </td>
            <td><a data-weapon-roll="parry">Parry</a></td>
          </tr>
          {{/if}}
        {{/each}}
        </tbody>
      </table>
      <!-- TODO Show Dodge skill & maybe knockback? -->
      <!-- TODO Show spells for easy access? -->
      <div>
        <h2 class="norse">Spirit Combat</h2>
        <label class="norse">Spirit Combat Damage {{data.attributes.spiritCombatDamage}}</label>
        <table>
          <tr data-item-id="{{this.data.spiritCombatSkill._id}}">
            <td>Spirit Combat</td>
            <td class="text-right" data-item-roll><a>{{skillchance this.data.spiritCombatSkill._id this.actor._id}}%</a></td>
          </tr>
        </table>
      </div>
    </div>
  </div>

  {{!-- Sheet Tab Navigation --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item norse" data-tab="runes">Runes</a>
    <a class="item norse" data-tab="skills">Skills</a>
    <a class="item norse" data-tab="gear">Gear</a>
    <a class="item norse" data-tab="passions">Passions</a>
    <a class="item norse" data-tab="background">Background</a>
    <a class="item norse" data-tab="activeeffectstesting">üêõActive Effectsüß™</a>
  </nav>

  {{!-- Sheet Body --}}
  <section class="sheet-body">
    {{!-- Runes Tab --}}
    <div class="tab runes" data-group="primary" data-tab="runes">
      {{> "systems/rqg/actors/parts/runes-tab.html" }}
    </div>

    {{!-- Skills Tab --}}
    <div class="tab skills" data-group="primary" data-tab="skills">
      {{> "systems/rqg/actors/parts/skills-tab.html" }}
    </div>

    {{!-- Owned Items Tab --}}
    <div class="tab gear" data-group="primary" data-tab="gear">
      {{> "systems/rqg/actors/parts/gear-tab.html" }}
    </div>

    {{!-- Passions Tab --}}
    <div class="tab passions" data-group="primary" data-tab="passions">
      {{> "systems/rqg/actors/parts/passions-tab.html" }}
    </div>

    {{!-- Background Tab --}}
    <div class="tab background" data-group="primary" data-tab="background">
      {{> "systems/rqg/actors/parts/background-tab.html" }}
    </div>

    {{!-- Active Effects Testing Tab --}}
    <div class="tab activeeffectstesting" data-group="primary" data-tab="activeeffectstesting">
      {{> "systems/rqg/actors/parts/activeeffectstesting-tab.html" }}
    </div>
  </section>
</form>
