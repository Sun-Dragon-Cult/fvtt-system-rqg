<form class="card-form" data-chat-card="weaponCard">
  <div class="rqg chat-card weapon-card">
    <h2>
      <img class="item" src="{{card.chatImage}}">
      <i>{{cardHeading}}</i>
    </h2>

    <label>{{localize 'RQG.Dialog.Common.OtherModifiers'}}
      <input class="card-number-input" type="text" value="{{formData.otherModifiers}}" name="otherModifiers">
    </label>
    <i class="fas fa-arrow-right"></i> <span>{{chance}}%</span>

    <div class="flex-row flex-wrap gap03rem">
      {{#with (lookup weaponItemData.usage card.usage)}}
      {{#each combatManeuvers}}
            <button name="combatManeuverRoll" value="{{name}}"
                {{#if (eq name ../../formData.combatManeuverName)}}class="active"{{/if}}>
                {{localize (concat "RQG.Item.Weapon.combatManeuver." name)}}
            </button>
      {{/each}}
      {{/with}}
    </div>

    {{#if formData.actionName}}
      <hr>

      {{#if (eq formData.actionName "parry")}}
        {{#if (eq card.result 0)}}
          <h3>TODO Hyper Critical Not yet implemented</h3>
        {{/if}}

        {{#if (eq card.result 1)}}
          <h3>TODO Special Critical Not yet implemented</h3>
        {{/if}}

        {{#if (eq card.result 2)}}
          <div class="flex-row">
            <div class="damage">{{localize 'RQG.Dialog.weaponCard.Damage'}}</div>
            <button name="damageRoll" value="normal">{{localize 'RQG.Dialog.weaponCard.damageRollType.normal'}}</button>
            <button name="damageRoll" value="special">{{localize 'RQG.Dialog.weaponCard.damageRollType.special'}}</button>
          </div>
        {{/if}}

        {{#if (eq card.result 3)}}
          <div class="flex-row">
            <div class="damage">{{localize 'RQG.Dialog.weaponCard.Damage'}}</div>
            <button name="damageRoll" value="normal">{{localize 'RQG.Dialog.weaponCard.damageRollType.normal'}}</button>
            <button name="damageRoll" value="special">{{localize 'RQG.Dialog.weaponCard.damageRollType.special'}}</button>
          </div>
        {{/if}}

        {{#if (eq card.result 4)}}
          <div class="flex-row">
            <div class="damage">{{localize 'RQG.Dialog.weaponCard.Damage'}}</div>
            <button name="damageRoll" value="normal">{{localize 'RQG.Dialog.weaponCard.damageRollType.normal'}}</button>
          </div>
        {{/if}}

        {{#if (eq card.result 5)}}
        {{/if}}

        {{#if (eq card.result 6)}}
          <button name="fumbleRoll">{{localize 'RQG.Dialog.weaponCard.fumbleRoll'}}</button>
        {{/if}}
      {{else}} {{!-- not parry => (slash / impale / grapple / ...) --}}
        {{#if (eq card.result 0)}}
          <h3>TODO Hyper Critical Not yet implemented</h3>
        {{/if}}

        {{#if (eq card.result 1)}}
          <h3>TODO Special Critical Not yet implemented</h3>
        {{/if}}

        {{#if (eq card.result 2)}}
          {{#if card.specialDamageTypeText}}
            <p>{{{card.specialDamageTypeText}}}</p>
          {{else}}
            <div class="flex-row">
              <div class="damage">{{localize 'RQG.Dialog.weaponCard.Damage'}}</div>
              <button name="damageRoll" value="normal">{{localize 'RQG.Dialog.weaponCard.damageRollType.normal'}}</button>
              <button name="damageRoll" value="special">{{localize 'RQG.Dialog.weaponCard.damageRollType.special'}}</button>
              <button name="damageRoll" value="maxSpecial">{{localize 'RQG.Dialog.weaponCard.damageRollType.maxSpecial'}}</button>
            </div>
            <button name="hitLocationRoll">{{localize 'RQG.Dialog.weaponCard.hitLocationRoll'}}</button>
          {{/if}}
        {{/if}}
        {{#if (eq card.result 3)}}
          {{#if card.specialDamageTypeText}}
            <p>{{{card.specialDamageTypeText}}}</p>
          {{else}}
            <div class="flex-row">
              <div class="damage">{{localize 'RQG.Dialog.weaponCard.Damage'}}</div>
              <button name="damageRoll" value="normal">{{localize 'RQG.Dialog.weaponCard.damageRollType.normal'}}</button>
              <button name="damageRoll" value="special">{{localize 'RQG.Dialog.weaponCard.damageRollType.special'}}</button>
            </div>
            <button name="hitLocationRoll">{{localize 'RQG.Dialog.weaponCard.hitLocationRoll'}}</button>
          {{/if}}
        {{/if}}

        {{#if (eq card.result 4)}}
          {{#if card.specialDamageTypeText}}
            <p>{{{card.specialDamageTypeText}}}</p>
          {{else}}
            <div class="flex-row">
              <div class="damage">{{localize 'RQG.Dialog.weaponCard.Damage'}}</div>
              <button name="damageRoll" value="normal">{{localize 'RQG.Dialog.weaponCard.damageRollType.normal'}}</button>
            </div>
            <button name="hitLocationRoll">{{localize 'RQG.Dialog.weaponCard.hitLocationRoll'}}</button>
          {{/if}}
        {{/if}}

        {{#if (eq card.result 5)}}
          {{#if card.specialDamageTypeText}}
            <p>{{{card.specialDamageTypeText}}}</p>
          {{else}}
            <div class="flex-row">
              <div class="damage">{{localize 'RQG.Dialog.weaponCard.Damage'}}</div>
              <button name="damageRoll" value="normal">{{localize 'RQG.Dialog.weaponCard.damageRollType.normal'}}</button>
            </div>
            <button name="hitLocationRoll">{{localize 'RQG.Dialog.weaponCard.hitLocationRoll'}}</button>
          {{/if}}
        {{/if}}

        {{#if (eq card.result 6)}}
          <button name="fumbleRoll">{{localize 'RQG.Dialog.weaponCard.fumbleRoll'}}</button>
        {{/if}}
      {{/if}}
    {{/if}}
  </div>
</form>
